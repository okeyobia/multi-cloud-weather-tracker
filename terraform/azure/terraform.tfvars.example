# Azure Terraform Variables Example Configuration
# Copy this file to terraform.tfvars and update with your actual values

# ============================================================================
# Core Azure Configuration
# ============================================================================

# Primary AWS region where resources will be deployed
# Format: <region> (e.g., eastus, westus2, eastus2, northeurope)
azure_region = "eastus"

# Secondary AWS region for disaster recovery (optional)
# Uncomment to enable secondary region deployment
# azure_secondary_region = "westus2"

# Project name (used for naming all resources)
# Format: lowercase alphanumeric with hyphens, max 20 characters
project_name = "weather-tracker"

# Environment name for resource separation
# Valid values: dev, staging, production
environment = "dev"

# Enable secondary region for disaster recovery
# This creates duplicate resources in the secondary region
# enable_secondary_region = false

# Common tags applied to all resources
tags = {
  Project      = "WeatherTracker"
  Environment  = "dev"
  ManagedBy    = "Terraform"
  CostCenter   = "engineering"
  CreatedBy    = "terraform-azure"
}

# ============================================================================
# Virtual Network and Networking Configuration
# ============================================================================

# Virtual network address space for primary region
# Format: CIDR block (e.g., 10.0.0.0/8)
vnet_address_space = "10.0.0.0/8"

# AKS node pool subnet address prefix
# Must be within vnet_address_space
aks_subnet_prefix = "10.1.0.0/16"

# Application subnet address prefix
# Used for app-specific resources
app_subnet_prefix = "10.2.0.0/16"

# PostgreSQL database subnet address prefix
# Used for database connectivity
postgresql_subnet_prefix = "10.3.0.0/16"

# Secondary virtual network address space (if secondary region enabled)
# secondary_vnet_address_space = "10.10.0.0/8"

# ============================================================================
# Azure Kubernetes Service (AKS) Configuration
# ============================================================================

# Kubernetes version to run on AKS nodes
# Recommended: 1.28 or newer for production
kubernetes_version = "1.28"

# Number of initial nodes in the default node pool
# Minimum: 1, Recommended: 3 for HA
aks_node_count = 3

# Enable auto-scaling for the AKS node pool
# Highly recommended for production
aks_enable_auto_scaling = true

# Minimum number of nodes (when auto-scaling enabled)
# Minimum: 1
aks_min_nodes = 1

# Maximum number of nodes (when auto-scaling enabled)
# Should be at least 3x initial for burst capacity
aks_max_nodes = 10

# VM size for AKS nodes
# Recommended options:
#   - Dev: Standard_D2s_v3 (2 CPU, 8GB RAM)
#   - Staging: Standard_D4s_v3 (4 CPU, 16GB RAM)
#   - Production: Standard_D8s_v3 (8 CPU, 32GB RAM)
aks_vm_size = "Standard_D2s_v3"

# Network plugin for AKS
# Valid values: "azure" (CNI, recommended), "kubenet"
aks_network_plugin = "azure"

# Service CIDR for Kubernetes services
# Must not overlap with vnet_address_space or pod_cidr
aks_service_cidr = "10.1.0.0/16"

# Pod CIDR range
# Must not overlap with vnet_address_space or aks_service_cidr
aks_pod_cidr = "10.244.0.0/16"

# Kubernetes DNS service IP
# Must be within aks_service_cidr range (usually first few IPs)
aks_dns_service_ip = "10.1.0.10"

# Enable RBAC for AKS
# Highly recommended for production
aks_enable_rbac = true

# Enable Container Insights monitoring add-on
# Recommended for monitoring and troubleshooting
aks_enable_monitoring = true

# Enable Azure Policy add-on
# Recommended for compliance and policy enforcement
aks_enable_azure_policy = true

# Enable HTTP application routing (creates Route controller)
# Not recommended for production (use ingress controller instead)
# aks_enable_http_app_routing = false

# ============================================================================
# Azure PostgreSQL Configuration
# ============================================================================

# PostgreSQL major version
# Valid values: "11", "12", "13", "14", "15"
# Recommended: "15" for new deployments
postgresql_version = "15"

# PostgreSQL SKU
# Format: <tier>_<capacity>
# Recommended options:
#   - Dev: B_Standard_B2s (1 vCore, 2GB RAM)
#   - Staging: B_Standard_B4ms (2 vCore, 4GB RAM)
#   - Production: GP_Standard_D4s_v3 (4 vCore, 16GB RAM)
postgresql_sku_name = "B_Standard_B2s"

# Storage size in GB
# Valid range: 32-1048576 (32GiB - 1TiB)
# Recommended: 100GB for production
postgresql_storage_mb = 32768  # 32GB

# Enable high availability (zone-redundant)
# Recommended for production
postgresql_ha_enabled = true

# Backup retention period in days
# Valid range: 7-35
# Recommended: 30 for production
postgresql_backup_retention_days = 30

# Enable geo-redundant backups
# Recommended for production for disaster recovery
postgresql_geo_redundant_backup_enabled = true

# Enable SSL enforcement
# Strongly recommended for production
postgresql_ssl_enforcement_enabled = true

# PostgreSQL database name to create
postgresql_database_name = "weatherapp"

# PostgreSQL administrator login username
# Minimum 1 character, max 63 characters
# Keep this secure and use a strong password
postgresql_admin_username = "pgadmin"

# ============================================================================
# Azure Front Door Configuration
# ============================================================================

# Front Door SKU
# Valid values: "Standard_AzureFrontDoor", "Premium_AzureFrontDoor"
# Use Standard for cost-effective CDN, Premium for WAF and advanced features
front_door_sku = "Standard_AzureFrontDoor"

# Enable Web Application Firewall (WAF)
# Strongly recommended for production
enable_front_door_waf = true

# WAF policy mode
# Valid values: "Detection", "Prevention"
# Use Detection for testing, Prevention for production
front_door_waf_mode = "Prevention"

# Custom domain name for Front Door
# Format: example.com (without http/https)
# Leave empty to use default *.azurefd.net domain
# front_door_custom_domain = "api.example.com"

# Backend target port
# Typical: 443 for HTTPS, 80 for HTTP
front_door_backend_port = 443

# ============================================================================
# Azure Traffic Manager Configuration
# ============================================================================

# Traffic Manager profile name
# Leave empty to auto-generate from project_name
# traffic_manager_profile_name = "weather-tracker-tm"

# Traffic Manager routing method
# Valid values: "Performance", "Weighted", "Priority", "Geographic", "MultiValue", "Subnet"
# Recommended options:
#   - Performance: Route based on lowest latency
#   - Priority: Primary-secondary failover model
#   - Geographic: Route based on user geography
traffic_manager_routing_method = "Priority"

# Health check protocol
# Valid values: "HTTP", "HTTPS", "TCP"
# Recommended: "HTTPS" for production
traffic_manager_protocol = "HTTPS"

# Health check port
# Typical: 443 for HTTPS, 80 for HTTP
traffic_manager_port = 443

# Health check path
# Example: "/health", "/ping", "/api/health"
traffic_manager_path = "/health"

# Health check interval in seconds
# Valid range: 10-30
# Lower values detect failures faster but increase API calls
traffic_manager_interval = 30

# Timeout for health check responses in seconds
# Valid range: 5-10 (must be < traffic_manager_interval)
traffic_manager_timeout = 10

# Number of consecutive failures before endpoint is considered degraded
# Valid range: 1-10
# Recommended: 3 for production
traffic_manager_tolerated_failures = 3

# ============================================================================
# Monitoring and Logging Configuration
# ============================================================================

# Log Analytics workspace SKU
# Valid values: "PerGB2018", "Free", "Standalone", "PerNode", "Premium"
# Recommended: "PerGB2018" for production
log_analytics_sku = "PerGB2018"

# Log Analytics data retention in days
# Valid range: 30-730 (min 30 for production)
# Recommended: 90 for balance of history and cost
log_analytics_retention_days = 30

# Application Insights sampling rate
# Valid range: 0.0 - 100.0 (percentage)
# Recommended: 100 for production, 10-20 for high-volume apps
app_insights_sampling_rate = 100

# ============================================================================
# Key Vault Configuration
# ============================================================================

# Enable soft delete for Key Vault
# Recommended: true for production
key_vault_enable_soft_delete = true

# Enable purge protection for Key Vault
# Recommended: true for production
key_vault_enable_purge_protection = true

# ============================================================================
# Storage Configuration
# ============================================================================

# Enable blob soft delete for storage account
# Keeps deleted blobs for specified retention period
storage_enable_blob_soft_delete = true

# Blob soft delete retention days
# Valid range: 1-365
storage_blob_retention_days = 7

# ============================================================================
# Advanced Configuration
# ============================================================================

# Enable diagnostic logging for all services
enable_diagnostic_logging = true

# Application Gateway WAF rule set version
# Valid values: "2.2.9", "3.0", "3.1", "3.2"
# Recommended: "3.2" for latest protections
waf_rule_set_version = "3.2"

# AppConfiguration SKU
# Valid values: "Free", "Standard"
# Use Free for testing, Standard for production
# app_config_sku = "Standard"

# Deployment environment configuration
# Can be used for environment-specific settings
deployment_environment = "dev"

# ============================================================================
# Cost Optimization Options
# ============================================================================

# Enable Azure Hybrid Benefit (BYOL) for AKS nodes
# Reduces cost if you have existing licenses
# enable_azure_hybrid_benefit = false

# Use spot instances for non-critical workloads
# Significantly reduces costs but removes availability guarantee
# aks_enable_spot_instances = false

# ============================================================================
# Disaster Recovery Configuration
# ============================================================================

# Enable pilot light DR in secondary region
# Creates all resources in secondary region
# enable_secondary_region = true

# Backup and retention settings
backup_retention_days = 30
backup_frequency = "Daily"
